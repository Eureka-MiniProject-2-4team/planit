<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>팀 투두 테스트 페이지</title>
  <style>
    body {
      font-family: 'Arial', sans-serif;
      max-width: 800px;
      margin: 0 auto;
      padding: 20px;
    }
    h1, h2 {
      color: #333;
    }
    .section {
      margin-bottom: 30px;
      padding: 15px;
      border: 1px solid #ddd;
      border-radius: 5px;
    }
    .form-group {
      margin-bottom: 15px;
    }
    label {
      display: block;
      margin-bottom: 5px;
      font-weight: bold;
    }
    input[type="text"], textarea {
      width: 100%;
      padding: 8px;
      box-sizing: border-box;
      border: 1px solid #ccc;
      border-radius: 4px;
    }
    button {
      background-color: #4CAF50;
      color: white;
      padding: 10px 15px;
      border: none;
      border-radius: 4px;
      cursor: pointer;
    }
    button:hover {
      background-color: #45a049;
    }
    #response {
      margin-top: 20px;
      padding: 10px;
      border: 1px solid #ddd;
      border-radius: 5px;
      background-color: #f9f9f9;
      white-space: pre-wrap;
      max-height: 300px;
      overflow-y: auto;
    }
    .divider {
      margin: 30px 0;
      border-top: 2px dashed #ccc;
      padding-top: 20px;
    }
    h1.section-header {
      background-color: #f1f1f1;
      padding: 10px;
      border-radius: 5px;
      margin-top: 30px;
    }
  </style>
</head>
<body>
<h1>팀 투두 테스트 페이지</h1>

<div class="section">
  <h2>팀 ID 설정</h2>
  <div class="form-group">
    <label for="teamIdInput">팀 ID:</label>
    <input type="text" id="teamIdInput" value="aceacd14-9151-4f60-905b-266cf746f8d7">
  </div>
  <button onclick="setTeamId()">팀 ID 설정</button>
</div>

<h1 class="section-header">팀 투두 관리 (Team Todo Management)</h1>

<div class="section">
  <h2>1. 팀 투두 생성 (팀장만 가능)</h2>
  <div class="form-group">
    <label for="todoTitle">제목:</label>
    <input type="text" id="todoTitle" placeholder="투두 제목">
  </div>
  <div class="form-group">
    <label for="todoContent">내용:</label>
    <textarea id="todoContent" rows="3" placeholder="투두 내용"></textarea>
  </div>
  <button onclick="createTeamTodo()">투두 생성</button>
</div>

<div class="section">
  <h2>2. 팀 투두 리스트 조회</h2>
  <button onclick="getTeamTodoList()">투두 리스트 조회</button>
</div>

<div class="section">
  <h2>3. 팀 투두 상세 조회</h2>
  <div class="form-group">
    <label for="todoIdDetail">투두 ID:</label>
    <input type="text" id="todoIdDetail" placeholder="조회할 투두 ID">
  </div>
  <button onclick="getTeamTodoById()">투두 상세 조회</button>
</div>

<div class="section">
  <h2>4. 팀 투두 수정 (팀장만 가능)</h2>
  <div class="form-group">
    <label for="todoIdUpdate">투두 ID:</label>
    <input type="text" id="todoIdUpdate" placeholder="수정할 투두 ID">
  </div>
  <div class="form-group">
    <label for="todoTitleUpdate">제목:</label>
    <input type="text" id="todoTitleUpdate" placeholder="수정할 제목">
  </div>
  <div class="form-group">
    <label for="todoContentUpdate">내용:</label>
    <textarea id="todoContentUpdate" rows="3" placeholder="수정할 내용"></textarea>
  </div>
  <button onclick="updateTeamTodo()">투두 수정</button>
</div>

<div class="section">
  <h2>5. 팀 투두 삭제 (팀장만 가능)</h2>
  <div class="form-group">
    <label for="todoIdDelete">투두 ID:</label>
    <input type="text" id="todoIdDelete" placeholder="삭제할 투두 ID">
  </div>
  <button onclick="deleteTeamTodo()">투두 삭제</button>
</div>

<h1 class="section-header">개인별 팀 투두 관리 (My Team Todo Management)</h1>

<div class="section">
  <h2>6. 나의 팀 투두 전체 조회</h2>
  <p>내가 속한 팀의 모든 투두를 나의 상태로 가져옵니다.</p>
  <button onclick="getMyTeamListTodoList()">나의 팀 투두 전체 조회</button>
</div>

<div class="section">
  <h2>7. 나의 팀 투두 상세 조회</h2>
  <div class="form-group">
    <label for="teamTodoUserId">팀 투두 사용자 ID:</label>
    <input type="text" id="teamTodoUserId" placeholder="조회할 팀 투두 사용자 ID">
  </div>
  <button onclick="getMyTeamTodoDetail()">나의 팀 투두 상세 조회</button>
</div>

<div class="section">
  <h2>8. 나의 팀 투두 상태 변경</h2>
  <div class="form-group">
    <label for="teamTodoUserIdStatus">팀 투두 사용자 ID:</label>
    <input type="text" id="teamTodoUserIdStatus" placeholder="상태 변경할 팀 투두 사용자 ID">
  </div>
  <button onclick="updateMyTeamTodo()">투두 상태 변경</button>
</div>

<div id="response">응답 결과가 여기에 표시됩니다.</div>

<script>
  // 팀 ID 저장 변수
  let teamId = "aceacd14-9151-4f60-905b-266cf746f8d7";

  // 팀 ID 설정 함수
  function setTeamId() {
    teamId = document.getElementById('teamIdInput').value;
    showResponse(`팀 ID가 [${teamId}]로 설정되었습니다.`);
  }

  // 1. 팀 투두 생성
  function createTeamTodo() {
    const title = document.getElementById('todoTitle').value;
    const content = document.getElementById('todoContent').value;

    if (!title) {
      showResponse("제목을 입력해주세요.");
      return;
    }

    fetch(`/api/team/${teamId}/todo`, {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
        'Authorization': localStorage.getItem('accessToken')
      },
      body: JSON.stringify({
        title: title,
        content: content
      })
    })
            .then(response => response.json())
            .then(data => {
              showResponse(data);
            })
            .catch(error => {
              showResponse(`오류 발생: ${error}`);
            });
  }

  // 2. 팀 투두 리스트 조회
  function getTeamTodoList() {
    fetch(`/api/team/${teamId}/todo/list`, {
      method: 'GET',
      headers: {
        'Authorization': localStorage.getItem('accessToken')
      }
    })
            .then(response => response.json())
            .then(data => {
              showResponse(data);
            })
            .catch(error => {
              showResponse(`오류 발생: ${error}`);
            });
  }

  // 3. 팀 투두 상세 조회
  function getTeamTodoById() {
    const todoId = document.getElementById('todoIdDetail').value;

    if (!todoId) {
      showResponse("조회할 투두 ID를 입력해주세요.");
      return;
    }

    fetch(`/api/team/${teamId}/todo/${todoId}`, {
      method: 'GET',
      headers: {
        'Authorization': localStorage.getItem('accessToken')
      }
    })
            .then(response => response.json())
            .then(data => {
              showResponse(data);
            })
            .catch(error => {
              showResponse(`오류 발생: ${error}`);
            });
  }

  // 4. 팀 투두 수정
  function updateTeamTodo() {
    const todoId = document.getElementById('todoIdUpdate').value;
    const title = document.getElementById('todoTitleUpdate').value;
    const content = document.getElementById('todoContentUpdate').value;

    if (!todoId || !title) {
      showResponse("투두 ID와 제목을 모두 입력해주세요.");
      return;
    }

    fetch(`/api/team/${teamId}/todo/${todoId}`, {
      method: 'PUT',
      headers: {
        'Content-Type': 'application/json',
        'Authorization': localStorage.getItem('accessToken')
      },
      body: JSON.stringify({
        title: title,
        content: content
      })
    })
            .then(response => response.json())
            .then(data => {
              showResponse(data);
            })
            .catch(error => {
              showResponse(`오류 발생: ${error}`);
            });
  }

  // 5. 팀 투두 삭제
  function deleteTeamTodo() {
    const todoId = document.getElementById('todoIdDelete').value;

    if (!todoId) {
      showResponse("삭제할 투두 ID를 입력해주세요.");
      return;
    }

    fetch(`/api/team/${teamId}/todo/${todoId}`, {
      method: 'DELETE',
      headers: {
        'Authorization': localStorage.getItem('accessToken')
      }
    })
            .then(response => response.json())
            .then(data => {
              showResponse(data);
            })
            .catch(error => {
              showResponse(`오류 발생: ${error}`);
            });
  }

  // 6. 나의 팀 투두 전체 조회
  function getMyTeamListTodoList() {
    fetch(`/api/team/${teamId}/todo/my/list`, {
      method: 'GET',
      headers: {
        'Authorization': localStorage.getItem('accessToken')
      }
    })
            .then(response => response.json())
            .then(data => {
              showResponse(data);
            })
            .catch(error => {
              showResponse(`오류 발생: ${error}`);
            });
  }

  // 7. 나의 팀 투두 상세 조회
  function getMyTeamTodoDetail() {
    const teamTodoUserId = document.getElementById('teamTodoUserId').value;

    if (!teamTodoUserId) {
      showResponse("확인할 나의 팀 투두 ID를 입력해주세요.");
      return;
    }

    fetch(`/api/team/${teamId}/todo/my/${teamTodoUserId}`, {
      method: 'GET',
      headers: {
        'Authorization': localStorage.getItem('accessToken')
      }
    })
            .then(response => response.json())
            .then(data => {
              showResponse(data);
            })
            .catch(error => {
              showResponse(`오류 발생: ${error}`);
            });
  }

  // 8. 나의 팀 투두 상태 변경
  function updateMyTeamTodo() {
    const teamTodoUserId = document.getElementById('teamTodoUserIdStatus').value;

    if (!teamTodoUserId) {
      showResponse("수정할 나의 팀 투두 ID를 입력해주세요.");
      return;
    }

    fetch(`/api/team/${teamId}/todo/my/${teamTodoUserId}`, {
      method: 'PUT',
      headers: {
        'Content-Type': 'application/json',
        'Authorization': localStorage.getItem('accessToken')
      },
      body: JSON.stringify({
        teamTodoId : "이게 아닌데",
        userId : "이것도 아니고",
        isCompleted : false
      })
    })
            .then(response => response.json())
            .then(data => {
              showResponse(data);
            })
            .catch(error => {
              showResponse(`오류 발생: ${error}`);
            });
  }

  // 응답 표시 함수
  function showResponse(data) {
    const responseElement = document.getElementById('response');
    if (typeof data === 'object') {
      responseElement.textContent = JSON.stringify(data, null, 2);
    } else {
      responseElement.textContent = data;
    }
  }

  // 페이지 로드 시 accessToken 확인
  document.addEventListener('DOMContentLoaded', function() {
    if (!localStorage.getItem('accessToken')) {
      showResponse("주의: accessToken이 설정되어 있지 않습니다. 로그인이 필요할 수 있습니다.");
    }
  });
</script>
</body>
</html>